sudo: required

services:
  - docker
  
before_install:
- docker pull google/golang

install:
- docker build --rm=true -t jangaraj/go-app:binary -f devops/Dockerfile . 
- docker run --rm=true -ti -v $PWD:/tmp jangaraj/go-app:binary cp /main /tmp
- docker build --rm=true -t jangaraj/go-app:$TRAVIS_BUILD_NUMBER .

deploy:
- docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
- docker push jangaraj/go-app:$TRAVIS_BUILD_NUMBER